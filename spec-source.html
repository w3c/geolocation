<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
 <head>
  <title>Geolocation API Specification</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
  <style type="text/css">
   dt, dfn { font-weight: bold; font-style: normal; }
   img.extra { float: right; }
   body ins, body del { display: block; }
   body * ins, body * del { display: inline; }
   pre, code { color: black; background: transparent; font-size: inherit; font-family: monospace; }
   pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
   pre em { font-weight: bolder; font-style: normal; }
   pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
   pre.idl { border: solid thin; background: #EEEEEE; color: black; padding: 0.5em; }
   table { border-collapse: collapse; border-style: hidden hidden none hidden; }
   table thead { border-bottom: solid; }
   table tbody th:first-child { border-left: solid; }
   table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
   ul.toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
   ul.toc li ul { margin-bottom: 0.75em; }
   ul.toc li ul li ul { margin-bottom: 0.25em; }
   var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
   @media screen { code { color: rgb(255, 69, 0); background: transparent; } }
   code :link, code :visited { color: inherit; background: transparent; }
   .example { display: block; color: #222222; background: #FCFCFC; border-left: double; margin-left: 1em; padding-left: 1em; }
   .issue, .big-issue { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
   .issue > :first-child, .big-issue > :first-child { margin-top: 0; }
   p .big-issue { line-height: 3em; }
   .note { color: green; background: transparent; }
   .note { font-family: sans-serif; }
   p.note:before { content: 'Note: '; }
   .warning { color: red; background: transparent; }
   .warning:before { font-style: normal; }
   p.warning:before { content: '\26A0 Warning! '; }
   .note, .warning { font-weight: bolder; font-style: italic; padding: 0.5em 2em; }
   .copyright { margin: 0.25em 0; }
   img { max-width: 100%; }
   h4 + .element { margin-top: -2.5em; padding-top: 2em; }
   h4 + p + .element { margin-top: -5em; padding-top: 4em; }
   .element { background: #EEEEFF; color: black; margin: 0 0 1em -1em; padding: 0 1em 0.25em 0.75em; border-left: solid #9999FF 0.25em; }
   table.matrix, table.matrix td { border: none; text-align: right; }
   table.matrix { margin-left: 2em; }
  </style>
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED.css">
 </head>
 <body>
  <div class="head">
  <!--logo-->

  <h1 id="title_heading">Geolocation API Specification</h1>

  <h2 class="no-num no-toc">Editor's Draft [DATE: 3 April 2009]</h2>
   <dl>
<!--
    <dt>This version:</dt>
      <dd><a href="http://www.w3.org/Style/Group/css3-src/css3-template/%5BVERSION%5D">http://www.w3.org/TR/[YEAR]/MO-[SHORTNAME]-[CDATE]</a></dd>
-->
    <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/geolocation-API/">http://www.w3.org/TR/geolocation-API/</a></dd>
    <dt>Latest editor's draft:</dt>
      <dd><a href="http://dev.w3.org/geo/api/spec-source.html">http://dev.w3.org/geo/api/spec-source.html</a></dd>
<!--
    <dt>Previous version:</dt>
      <dd><a href="http://www.w3.org/Style/Group/css3-src/css3-template/%5Bhttp://www.w3.org/PreviousVersionURI%5D">[http://www.w3.org/PreviousVersionURI]</a></dd>
-->
    <dt>Editors:</dt>
      <dd>Andrei Popescu, Google, Inc</dd>
   </dl>
   <hr>
  </div>

  <h2 class="no-num no-toc" id="abstract">Abstract</h2>

  <p>This specification defines an API that provides scripted access
  to geographical location information associated with the hosting device.</p>


  <h2 class="no-num no-toc" id="status">Status of this document</h2>

  <!-- intro boilerplate (required) -->
  <p><em>This section describes the status of this document at the
  time of its publication. Other documents may supersede this
  document. A list of current W3C publications and the most recently
  formally published revision of this technical report can be found in
  the <a href="http://www.w3.org/TR/">W3C technical reports index</a>
  at http://www.w3.org/TR/.</em></p>

  <!-- where to send feedback (required) -->
  <p>If you wish to make comments regarding this document, please send
  them to <a
  href="mailto:public-geolocation@w3.org">public-geolocation@w3.org</a> (<a
  href="mailto:public-geolocation-request@w3.org?subject=subscribe">subscribe</a>,
  <a
  href="http://lists.w3.org/Archives/Public/public-geolocation/">archives</a>). All
  feedback is welcome.</p>

  <!-- stability (required) -->
  <p>Implementors should be aware that this specification is not
  stable. <strong>Implementors who are not taking part in the
  discussions are likely to find the specification changing out from
  under them in incompatible ways.</strong> Vendors interested in
  implementing this specification before it eventually reaches the
  Candidate Recommendation stage should join the aforementioned
  mailing list and take part in the discussions.</p>

  <!-- status of document, group responsible (required) -->
  <p>The <a href="http://www.w3.org/2008/geolocation/">Geolocation Working Group</a> is responsible for this document.  
	<strong>This is just an informal proposal at this
  time.</strong></p>

  <!-- required patent boilerplate -->
  <!--<p>This document was produced by a group operating under the <a
  href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5
  February 2004 W3C Patent Policy</a>. W3C maintains a <a
  rel="disclosure"
  href="http://www.w3.org/2004/01/pp-impl/40318/status">public list of
  any patent disclosures</a> made in connection with the deliverables
  of the group; that page also includes instructions for disclosing a
  patent. An individual who has actual knowledge of a patent which the
  individual believes contains <a
  href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
  Claim(s)</a> must disclose the information in accordance with <a
  href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
  6 of the W3C Patent Policy</a>.</p>-->


  <h2 class="no-num no-toc" id="contents">Table of contents</h2>

  <!--begin-toc-->
  <p>[If you keep the &lt;!--comment--&gt; the table of contents will be
  included here automatically.]</p>
  <!--end-toc-->


  <h2 id="introduction">Introduction</h2>

  <p><em>This section is non-normative.</em></p>

  <p>The Geolocation API defines a high-level interface to location
  information associated only with the device hosting the
  implementation, such as latitude and longitude.  The API itself is
  agnostic of the underlying location information sources.  Common
  sources of location information include Global Positioning System
  (GPS) and location inferred from network signals such as IP address,
  RFID, WiFi and Bluetooth MAC addresses, and GSM/CDMA cell IDs.</p>

  <p>The API is designed to enable both "one-shot" position requests
  and repeated position updates, as well as the ability to explicitly query
  the cached positions. Location information is represented by
  latitude and longitude coordinates. The Geolocation API in this
  specification builds upon earlier work in the industry, including <a
  href="#ref-azaloc" shape="rect">[AZALOC]</a>, <a href="#ref-gears"
  shape="rect">[GEARSLOC]</a>, and <a href="#ref-locationaware"
  shape="rect">[LOCATIONAWARE]</a>.</p>

  <p>The following code extract illustrates how to obtain
  basic location information:</p>

  <div class="example">
    <p> Example of a "one-shot" position request.</p>
    <pre>
    function showMap(position) {
      // Show a map centered at (position.coords.latitude, position.coords.longitude).
    }

    // One-shot position request.
    navigator.geolocation.getCurrentPosition(showMap);
    </pre>
  </div>
  <div class="example">
    <p>Example of requesting repeated position updates.</p>
    <pre>
    function scrollMap(position) {
      // Scrolls the map so that it is centered at (position.coords.latitude, position.coords.longitude).
    }

    // Request repeated updates.
    var watchId = navigator.geolocation.watchPosition(scrollMap);

    function buttonClickHandler() {
      // Cancel the updates when the user clicks a button.
      navigator.geolocation.clearWatch(watchId);
    }
    </pre>
  </div>

  <div class="example">
    <p>Example of requesting repeated position updates and handling errors.</p>
    <pre>
    function scrollMap(position) {
      // Scrolls the map so that it is centered at (position.coords.latitude, position.coords.longitude).
    }

    function handleError(error) {
      // Update a div element with error.message.
    }

    // Request repeated updates.
    var watchId = navigator.geolocation.watchPosition(scrollMap, handleError);

    function buttonClickHandler() {
      // Cancel the updates when the user clicks a button.
      navigator.geolocation.clearWatch(watchId);
    }
    </pre>
  </div>

  <div class="example">
    <p>Example of requesting a potentially cached position.</p>
    <pre>
    // Request a position. We accept positions whose age is not
    // greater than 10 minutes. If the User Agent does not have a
    // fresh enough cached position object, it will automatically
    // acquire a new one.
    navigator.geolocation.getCurrentPosition(successCallback,
                                             errorCallback,
                                             {maximumAge:600000});

    function successCallback(position) {
      // By using the 'maximumAge' option above, the position
      // object is guaranteed to be at most 10 minutes old.
    }

    function errorCallback(error) {
      // Update a div element with error.message.
    }

    </pre>
  </div>

  <div class="example">
    <p>Forcing the User Agent to return a fresh cached position.</p>
    <pre>
    // Request a position. We only accept cached positions whose age is not
    // greater than 10 minutes. If the User Agent does not have a fresh
    // enough cached position object, it will immediately invoke the error
    // callback.
    navigator.geolocation.getCurrentPosition(successCallback,
                                             errorCallback,
                                             {maximumAge:600000, timeout:0});

    function successCallback(position) {
      // By using the 'maximumAge' option above, the position
      // object is guaranteed to be at most 10 minutes old.
      // By using a 'timeout' of 0 milliseconds, if there is
      // no suitable cached position available, the User Agent 
      // will immediately invoke the error callback with code
      // TIMEOUT and will not initiate a new position
      // acquisition process.
    }

    function errorCallback(error) {
      switch(error.code) {
        case error.TIMEOUT:
          // Quick fallback when no suitable cached position exists.
          doFallback();
          // Acquire a new position object.
          navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
          break;
        case ... // treat the other error cases.
      };
    }

    function doFallback() {
      // No fresh enough cached position available.
      // Fallback to a default position.
    }
    </pre>
  </div>

  <div class="example">
    <p>Forcing the User Agent to return any available cached position.</p>
    <pre>
    // Request a position. We only accept cached positions, no matter what 
    // their age is. If the User Agent does not have a cached position at
    // all, it will immediately invoke the error callback.
    navigator.geolocation.getCurrentPosition(successCallback,
                                             errorCallback,
                                             {maximumAge:Infinity, timeout:0});

    function successCallback(position) {
      // By setting the 'maximumAge' to Infinity, the position
      // object is guaranteed to be a cached one.
      // By using a 'timeout' of 0 milliseconds, if there is
      // no cached position available at all, the User Agent 
      // will immediately invoke the error callback with code
      // TIMEOUT and will not initiate a new position
      // acquisition process.
      if (position.timestamp < freshness_threshold && 
          position.coords.accuracy < accuracy_threshold) {
        // The position is relatively fresh and accurate.
      } else {
        // The position is quite old and/or inaccurate.
      }
    }

    function errorCallback(error) {
      switch(error.code) {
        case error.TIMEOUT:
          // Quick fallback when no cached position exists at all.
          doFallback();
          // Acquire a new position object.
          navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
          break;
        case ... // treat the other error cases.
      };
    }

    function doFallback() {
      // No cached position available at all.
      // Fallback to a default position.
    }
    </pre>
  </div>

  <h2 id="scope">Scope</h2>
  <p><em>This section is non-normative.</em></p>
  
  <p>This specification is limited to providing a scripting APIs for
  retrieving geographic position information associated with a hosting
  device. The geographic position information is provided in terms of
  World Geodetic System coordinates <a href="#ref-wgs">[WGS84]</a>.</p>

  <p>The scope of this specification does not include providing a
  markup language of any kind.</p>

  <p>The scope of this specification does not include defining new URI
  schemes for building URIs that identify geographic locations.</p>

  <h2 id="security">Security and privacy considerations</h2>

  <p>The API defined in this specification can be used to retrieve the
  geographic location of a hosting device. In almost all cases, this
  information also discloses the location of the user of the device,
  thereby potentially compromising the user's privacy. A conforming
  implementation of this specification MUST provide a mechanism that
  protects the user's privacy and this mechanism SHOULD ensure that
  no location information is made available without the user's
  informed consent.</p>

  <h3 id="privacy_for_uas">Privacy considerations for implementors of the Geolocation API</h3>
  <p>User Agents must not send location information to websites
  without express permission of the user. Browsers should acquire
  permission through a user interface which will include the URI of
  the document origin. All permissions should be revocable, and User
  Agents should respect revoked permissions.</p>

  <p>Some User Agents will have prearranged trust relationships that
  do not require such user interfaces. For example, a Web browser will
  present a user interface when a Web site performs a geolocation
  request.  However, a VOIP telephone may not present any user
  interface when using location information to perform an E911
  function.</p>
  
  <h3 id="privacy_for_recipients">Privacy considerations for recipients of location information</h3>
  <p>The two primary concerns regarding recipients of location
  information are retention and retransmission. Recipients must only
  use the location information for the task for which it was provided
  to them and must dispose of it once completed, unless expressly
  permitted to do so. Recipients must also take measures to protect
  this information against unauthorized access. If location
  information is stored, users should be allowed to update and delete
  this information. The recipient of location information should not
  retransmit the location information without the userâ€™s consent. Care
  should be taken when retransmitting and use of HTTPS is
  encouraged. Furthermore, a clear and accessible privacy policy
  should be made available to all users that details the usage of
  location data. This should include any exceptions to the guidelines
  listed above.</p>
  
  <h2 id="conformance">Conformance requirements</h2>

  <p>All diagrams, examples, and notes in this specification are
  non-normative, as are all sections explicitly marked non-normative.
  Everything else in this specification is normative.</p>

  <p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
  NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
  "OPTIONAL" in the normative parts of this document are to be
  interpreted as described in RFC2119. For readability, these words do
  not appear in all uppercase letters in this specification. <a
  href="#refsRFC2119">[RFC2119]</a></p> <!-- XXX but they should be
  marked up -->
 
  <p>Requirements phrased in the imperative as part of algorithms
  (such as "strip any leading space characters" or "return false and
  abort these steps") are to be interpreted with the meaning of the
  key word ("must", "should", "may", etc) used in introducing the
  algorithm.</p>

  <p>Conformance requirements phrased as algorithms or specific steps
  may be implemented in any manner, so long as the end result is
  equivalent. (In particular, the algorithms defined in this
  specification are intended to be easy to follow, and not intended to
  be performant.)</p>
  
  <p id="hardwareLimitations">User agents may impose
  implementation-specific limits on otherwise unconstrained inputs,
  e.g. to prevent denial of service attacks, to guard against running
  out of memory, or to work around platform-specific limitations.</p>

  <p>Implementations that use ECMAScript to implement the APIs defined
  in this specification must implement them in a manner consistent
  with the ECMAScript Bindings defined in the Web IDL specification,
  as this specification uses that specification's terminology. <a
  href="#ref-WebIDL">[WEBIDL]</a></p>

  
  <h2 id="api_description">API Description</h2>


  <h3 id="geolocation_interface">Geolocation interface</h3>

  <p>The <code><a href="#geolocation">Geolocation</a></code> object can
  be used by scripts to programmatically determine the location
  information associated with the hosting device. The location
  information is acquired by applying a user-agent specific algorithm,
  creating a <code><a href="#position">Position</a></code> object, and
  populating that object with appropriate data accordingly.</p>

  <p>Objects implementing the <code>Navigator</code> interface
  (e.g. the <code>window.navigator</code> object) must also implement
  the <code><a href="#navi-geo">NavigatorGeolocation</a></code>
  interface. <a href="#ref-navigator">[NAVIGATOR]</a>. An instance
  of <code>NavigatorGeolocation</code> would be then obtained by using
  binding-specific casting methods on an instance
  of <code>Navigator</code>.</p>

  <pre class="idl">
  [NoInterfaceObject]
  interface <dfn id="navi-geo">NavigatorGeolocation</dfn> {
    readonly attribute <a href="#geolocation">Geolocation</a> geolocation;
  };
  </pre>
  
  <p><br></p>

  <pre class="idl"> interface <dfn id="geolocation">Geolocation</dfn> { 
    void <a href="#get-current-position">getCurrentPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback);
    void <a href="#get-current-position">getCurrentPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback, in <a href="#error-callback">PositionErrorCallback</a> errorCallback);
    void <a href="#get-current-position">getCurrentPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback, in <a href="#error-callback">PositionErrorCallback</a> errorCallback, in <a href="#position-options">PositionOptions</a> options);

    int <a href="#watch-position">watchPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback);
    int <a href="#watch-position">watchPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback, in <a href="#error-callback">PositionErrorCallback</a> errorCallback);
    int <a href="#watch-position">watchPosition</a>(in <a href="#position-callback">PositionCallback</a> successCallback, in <a href="#error-callback">PositionErrorCallback</a> errorCallback, in <a href="#position-options">PositionOptions</a> options);

    void <a href="#clear-watch">clearWatch</a>(in int watchId);
  };

  interface <dfn id="position-callback">PositionCallback</dfn> {
    void handleEvent(in <a href="#position">Position</a> position);
  };

  interface <dfn id="error-callback">PositionErrorCallback</dfn> {
    void handleEvent(in <a href="#position-error">PositionError</a> error);
  };
  </pre>
  
  <p>The <dfn id="get-current-position"><code>getCurrentPosition()</code></dfn>
  takes one, two or three arguments. When called, it must immediately
  return and then asynchronously acquire a new <code><a href="#position">Position</a></code> object.

  If successful, this method must invoke its associated
  <code>successCallback</code> argument with a <code><a
  href="#position">Position</a></code> object as an argument. If the
  attempt fails, and the method was invoked with a non-null
  <code>errorCallback</code> argument, this method must invoke the
  <code>errorCallback</code> with a <code><a
  href="#position-error">PositionError</a></code> object as an
  argument.</p>

  <p>The <dfn id="watch-position"><code>watchPosition()</code></dfn>
  takes one, two or three arguments. When called, it must immediately
  return and then asynchronously start a <i>watch process</i> defined
  as the following set of steps:

  <ol>
    <li>
    Acquire a new <code><a href="#position">Position</a></code> object.
    If successful, invoke the associated <code>successCallback</code> with a <code><a
    href="#position">Position</a></code> object as an argument.
   
    If the attempt fails, and the method was invoked with a non-null
    <code>errorCallback</code> argument, this method must invoke the
    <code>errorCallback</code> with a <code><a
    href="#position-error">PositionError</a></code> object as an
    argument.
    </li>
    <li>
    Invoke the appropriate callback with a new <code>Position</code>
    object every time the implementation determines that the position
    of the hosting device has changed.
    </li>

  </ol>
  
  <p>This method returns an integer value that uniquely identifies the
  watch process. When the <dfn id="clear-watch"><code>clearWatch()</code></dfn> 
  method is called with this identifier, the watch process must stop
  acquiring any new position fixes and must cease invoking any callbacks.</p>

  <h3 id="position_options_interface">PositionOptions interface</h3>

  <p>The <code><a href="#get-current-position">getCurrentPosition()</a></code> and 
  <code><a href="#watch-position">watchPosition()</a></code> methods
  accept <code><a href="#position-options">PositionOptions</a></code> objects as
  their third argument.</p>
  
  <p> <code><a href="#position-options">PositionOptions</a></code>
  objects are regular ECMAScript objects that have the following properties:</p>

  <pre class="idl">
  [NoInterfaceObject]
  interface <dfn id="position-options">PositionOptions</dfn> {
    attribute boolean <a href="#high-accuracy">enableHighAccuracy</a>;
    attribute long <a href="#timeout">timeout</a>;
    attribute long <a href="#max-age">maximumAge</a>;
  };

  </pre>

  <p>The <code>enableHighAccuracy</code>, <code>timeout</code>
  and <code>maximumAge</code> attributes are all optional.</p>

  <p>The <dfn id="high-accuracy"><code>enableHighAccuracy</code></dfn>
  attribute provides a hint that the application would like to receive
  the best possible results. This may result in slower response times
  or increased power consumption. The user might also deny this
  capability, or the device might not be able to provide more accurate
  results than if the flag wasn't specified.</p>

  <div class="issue">See
  <ul>
    <li><a href="http://lists.w3.org/Archives/Public/public-geolocation/2008Jun/0094.html">http://lists.w3.org/Archives/Public/public-geolocation/2008Jun/0094.html</a></li>
    <li><a href="http://lists.w3.org/Archives/Public/public-geolocation/2008Jun/0107.html">http://lists.w3.org/Archives/Public/public-geolocation/2008Jun/0107.html</a></li>
  </ul>
  for two descriptions of the problem that <code>enableHighAccuracy</code> is trying to solve.
  </div>

  <p>The <dfn id="timeout"><code>timeout</code></dfn> attribute denotes
   the maximum length of time (expressed in milliseconds) that is
   allowed to pass from the call to
   <code>getCurrentPosition()</code> or <code>watchPosition()</code>
   until the corresponding <code>successCallback</code> is invoked. If
   the implementation is unable to successfully acquire a new <code>Position</code>
   before the given timeout elapses, and no other errors have occurred
   in this interval, then the corresponding <code>errorCallback</code>
   must be invoked with a <code>PositionError</code> object whose code
   attribute is set to <a href="#timeout_error">TIMEOUT</a>.</p>
   
  <p class="note">Before executing a call to
  to <code>getCurrentPosition()</code>
  or <code>watchPosition()</code>, an implementation may first need to
  acquire the user's permission to disclose location information to
  the current application origin. In such a case, the timeout interval
  starts immediately after the user's permission has been successfully
  acquired.</p>

  <p>In case of a <code>getCurrentPosition()</code> call, the
  <code>errorCallback</code> would be invoked exactly once.  

  <p>In case of a <code>watchPosition()</code>, the
  <code>errorCallback</code> could be invoked repeatedly: the first
  timeout is relative to the moment <code>watchPosition()</code> was
  called, while subsequent timeouts are relative to the moment when
  the implementation determines that the position of the hosting
  device has changed and a new <code>Position</code> object must be
  acquired.</p>

  <p>The <dfn id="max-age"><code>maximumAge</code></dfn> attribute
  indicates that the application is willing to accept a cached
  position whose age is no greater than the specified time in
  milliseconds. If <code>maximumAge</code> is not specified or set to 0,
  the implementation must immediately attempt to acquire a new
  position object. Setting the <code>maximumAge</code> to Infinity
  will force the implementation to return a cached position regardless
  of its age. If an implementation does not have available a cached
  position whose age is no greater than the
  specified <code>maximumAge</code>, then it must acquire a new
  position object. In case of a <code>watchPosition()</code>,
  the <code>maximumAge</code> refers to the first position object
  returned by the implementation.</p>

  <h3 id="position_interface">Position interface</h3>

  <p>The <code>Position</code> interface is the container for the
  geolocation information returned by this API. This version of the
  specification allows one attribute of
  type <code><a href="#coordinates">Coordinates</a></code> and a <a href="#timestamp"><code>timestamp</code></a>. Future versions of
  the API may allow additional attributes that provide other information about this position (e.g. street addresses).

  <pre class="idl">
  interface <dfn id="position">Position</dfn> {
    readonly attribute <a href="#coordinates">Coordinates</a> <a href="#coords">coords</a>;
    readonly attribute DOMTimeStamp <a href="#timestamp">timestamp</a>;
  };
  </pre>

  <p>The <dfn id="coords"><code>coords</code></dfn> attribute contains
  a set of geographic coordinates together with their associated
  accuracy, as well as a set of other optional attributes such as
  altitude and speed.

  <p>The <dfn id="timestamp"><code>timestamp</code></dfn> attribute
  represents the time when the <code>Position</code> object was acquired and is
  represented as a DOMTimeStamp <a href="#ref-domtimestamp">[DOMTIMESTAMP]</a>.</p>

  <h3 id="position_interface">Coordinates interface</h3>

  <pre class="idl">
  interface <dfn id="coordinates">Coordinates</dfn> {
    readonly attribute double <a href="#lat">latitude</a>;
    readonly attribute double <a href="#lon">longitude</a>;
    readonly attribute double <a href="#altitude">altitude</a>;
    readonly attribute double <a href="#accuracy">accuracy</a>;
    readonly attribute double <a href="#altitude-accuracy">altitudeAccuracy</a>;
    readonly attribute double <a href="#heading">heading</a>;
    readonly attribute double <a href="#speed">speed</a>;
  };
  </pre>

  <p>The geographic coordinate reference system used by the attributes in this interface is the World Geodetic System (2d) <a href="#ref-wgs">[WGS84]</a>. No other reference system is supported.</p>

  <p>The <dfn id="lat"><code>latitude</code></dfn> and <dfn id="lon"><code>longitude</code></dfn> 
  attributes are geographic coordinates specified in decimal degrees.</p>

  <p>The <dfn id="altitude"><code>altitude</code></dfn> attribute
  denotes the height of the position, specified in meters above the <a
  href="#ref-wgs">[WGS84]</a> ellipsoid. If the implementation cannot
  provide altitude information, the value of this attribute must be
  null.</p>
  
  <p>The <dfn id="accuracy"><code>accuracy</code></dfn> attribute
  denotes the accuracy level of the latitude and longitude coordinates. It
  is specified in meters and must be supported by all implementations.

  <p>The <dfn id="altitude-accuracy"><code>altitudeAccuracy</code></dfn> attribute
  is specified in meters. If the implementation cannot provide
  altitude information, the value of this attribute must be null.</p>

  <p>The <code>accuracy</code> and <code>altitudeAccuracy</code>
  values returned by an implementation should correspond to a 95%
  confidence level.

  <p>The <dfn id="heading"><code>heading</code></dfn> attribute
  denotes the direction of travel of the hosting device and is specified in
  degrees counting clockwise relative to the true north.  If the
  implementation cannot provide heading information, the value of this
  attribute must be null.</p>

  <p>The <dfn id="speed"><code>speed</code></dfn> attribute
  denotes the current ground speed of the hosting device and is
  specified in meters per second.  If the implementation cannot
  provide speed information, the value of this attribute must be
  null.</p>

  <h3 id="position_error_interface">PositionError interface</h3>

  <pre class="idl">
  interface <dfn id="position-error">PositionError</dfn> {
    const unsigned short <a href="#unknown_error">UNKNOWN_ERROR</a> = 0;
    const unsigned short <a href="#permission_denied_error">PERMISSION_DENIED</a> = 1;
    const unsigned short <a href="#position_unavailable_error">POSITION_UNAVAILABLE</a> = 2;
    const unsigned short <a href="#timeout_error">TIMEOUT</a> = 3;
    readonly attribute unsigned short <a href="#code">code</a>;
    readonly attribute DOMString <a href="#message">message</a>;
  };
  </pre>

  <p>The <dfn id="code"><code>code</code></dfn> attribute must return
  the appropriate code from the following list:</p>
  
  <dl>
    <dt><dfn id="unknown_error"><code>UNKNOWN_ERROR</code></dfn> (numeric value 0)</dt>
    <dd>The location acquisition process failed due to an error not
    covered by the definition of any other error code in this
    interface.</dd>

    <dt><dfn id="permission_denied_error"><code>PERMISSION_DENIED</code></dfn> (numeric value 1)</dt>
    <dd>The location acquisition process failed because the application
    origin does not have permission to use the Geolocation API.</dd>

    <dt><dfn id="position_unavailable_error"><code>POSITION_UNAVAILABLE</code></dfn> (numeric value 2)</dt>
    <dd>The position of the device could not be determined. One or
    more of the location providers used in the location acquisition
    process reported an internal error that caused the process to
    fail entirely.</dd>

    <dt><dfn id="timeout_error"><code>TIMEOUT</code></dfn> (numeric value 3)</dt>
    <dd>The specified maximum length of time has elapsed before the
    implementation could successfully acquire a new Position
    object.</dd>
  </dl>

  <p>The <dfn id="message"><code>message</code></dfn> attribute must
  return an error message describing the details of the error
  encountered. This attribute is primarily intended for debugging and
  developers should not use it directly in their application user
  interface.</p>

  <h2 id="usecases">Use-Cases and Requirements</h2>

  <p><em>Issue note: This section will get moved to a separate document</em></p>
  
  <h3 id="usecases_section">Use-Cases</h3>
  
  <h4>Find points of interest in the user's area</h4> 
  <p>Someone visiting a foreign city could access a Web application
  that allows users to search or browse through a database of tourist
  attractions. Using the Geolocation API, the Web application has
  access to the user's approximate position and it is therefore able to
  rank the search results by proximity to the user's location.</p>

  <h4>Annotating content with location information</h4>
  <p> A group of friends is hiking through the Scottish
  highlands. Some of them write short notes and take pictures at
  various points throughout the journey and store them using a Web
  application that can work offline on their hand-held
  devices. Whenever they add new content, the application
  automatically tags it with location data from the Geolocation API
  (which, in turn, uses the on-board GPS device). Every time they
  reach a town or a village, and they are again within network
  coverage, the application automatically uploads their notes and
  pictures to a popular blogging Web site, which uses the geolocation
  data to construct links that point to a mapping service. Users who
  follow the group's trip can click on these links to see a satellite
  view of the area where the notes were written and the pictures were
  taken. Another example is a life blog where a user creates content
  (e.g. images, video, audio) that records her every day
  experiences. This content can be automatically annotated with
  information such as time, geographic position or even the user's
  emotional state at the time of the recording.</p>

  <h4>Show the user's position on a map</h4>
  <p>A user finds herself in an unfamiliar city area. She wants to
  check her position so she uses her hand-held device to navigate to a
  Web-based mapping application that can pinpoint her exact location
  on the city map using the Geolocation API.  She then asks the Web
  application to provide driving directions from her current position
  to her desired destination.</p>

  <h4>Turn-by-turn route navigation</h4>
  <p>Following from use-case 4, a mapping application can help the
  user navigate along a route by providing detailed turn-by-turn
  directions. The application does this by registering with the
  Geolocation API to receive repeated location updates of the user's
  position. These updates are delivered as soon as the implementing
  User Agent determines that the position of the user has changed,
  which allows the application to anticipate any changes of direction
  that the user might need to do.</p>

  <h4>Alerts when points of interest are in the user's vicinity</h4>
  <p>A tour-guide Web application can use the Geolocation API to
  monitor the user's position and trigger visual or audio
  notifications when interesting places are in the vicinity. An online
  task management system can trigger reminders when the user is in the
  proximity of landmarks that are associated with certain tasks.</p>

  <h4>Up-to-date local information</h4>
  <p>A widget-like Web application that shows the weather or news that
  are relevant to the user's current area can use the Geolocation API
  to register for location updates. If the user's position changes,
  the widget can adapt the content accordingly.</p>

  <h4>Location-tagged status updates in social networking applications</h4>
  <p>A social network application allows its users to automatically
  tag their status updates with location information. It does this by
  monitoring the user's position with the Geolocation API. Each user
  can control the granularity of the location information (e.g. city
  or neighbourhood level) that is shared with the other users. Any
  user can also track his network of friends and get real-time updates
  about their current location.</p>

 <h3 id="requirements_section">Requirements</h3>

 <h4>The Geolocation API must provide location data in terms of a pair
 of latitude and longitude coordinates.</h4>

 <h4>The Geolocation API must provide information about the accuracy
 of the retrieved location data.</h4>

 <h4>The Geolocation API must support "one-shot" position updates.</h4>
 
 <h4>The Geolocation API must allow an application to register to
 receive updates when the position of the hosting device
 changes.</h4>

 <h4>The Geolocation API must allow an application to cheaply query the last
 known position.</h4>

 <h4>The Geolocation API must provide a way for the application to
 receive updates about errors that may have occurred while obtaining a
 location fix.</h4>

 <h4>The Geolocation API must allow an application to specify a
 desired accuracy level of the location information.</h4>

 <h4>The Geolocation API must be agnostic to the underlying sources
 of location information.</h4>


  <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

  <p>Alec Berntson, Steve Block, Greg Bolsinga, Aaron Boodman, Dave
  Burke, Chris Butler, Shyam Habarakada, Ian Hickson, Brad Lassey,
  Daniel Park, Stuart Parmenter, Olli Pettay, Chris Prince, Arun
  Ranganathan, Aza Raskin, Carl Reed, Allan Thomson, Martin Thomson, Doug Turner,
  Erik Wilde, Mohamed Zergaoui</p>


  <h2 class="no-num" id="references">References</h2>

  <dl>
   <dt><a id="ref-azaloc">[AZALOC]</a></dt>
   <dd><em>(Non-normative)</em> <cite><a href="http://azarask.in/blog/post/geolocation-in-firefox-and-beyond/">Geolocation in Firefox and Beyond</a></cite>. See http://azarask.in/blog/post/geolocation-in-firefox-and-beyond</dd>
   <dt><a id="ref-navigator">[NAVIGATOR]</a></dt>
   <dd><cite><a href="http://www.whatwg.org/specs/web-apps/current-work/#navigator">Navigator interface in HTML5</a></cite>. See http://www.whatwg.org/specs/web-apps/current-work/#navigator</dd>
   <dt><a id="ref-domtimestamp">[DOMTIMESTAMP]</a></dt>
   <dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#Core-DOMTimeStamp">The DOMTimeStamp Type</a></cite>. See http://www.w3.org/TR/DOM-Level-3-Core/core.html#Core-DOMTimeStamp</dd>
   <dt><a id="ref-gears">[GEARSLOC]</a></dt>
   <dd><em>(Non-normative)</em> <cite><a href="http://code.google.com/p/google-gears/wiki/GeolocationAPI">Gears Geolocation API</a></cite>. See http://code.google.com/p/google-gears/wiki/GeolocationAPI</dd>
   <dt><a id="ref-locationaware">[LOCATIONAWARE]</a></dt>
   <dd><em>(Non-normative)</em> <cite><a href="http://locationaware.org/wiki/index.php?title=Working_Draft">LocationAware.org Working Draft</a></cite>. See http://locationaware.org/wiki/index.php?title=Working_Draft</dd>
   <dt><a id="ref-rfc3066">[RFC3066]</a></dt>
   <dd><cite><a href="http://www.ietf.org/rfc/rfc3066.txt">Tags for the Identification of Languages</a></cite>. See http://www.ietf.org/rfc/rfc3066.txt</dd>
   <dt><a id="ref-webidl">[WEBIDL]</a></dt>
   <dd><cite><a href="http://www.w3.org/TR/WebIDL/">Web IDL</a></cite>. See http://www.w3.org/TR/WebIDL/</dd>
   <dt><a id="ref-wgs">[WGS84]</a></dt>
   <dd><cite><a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">National Imagery and Mapping Agency Technical Report 8350.2, Third Edition</a></cite>. See http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf</dd>
  </dl>

 </body>
</html>
